extends layout

block content
	// TITLE & SEARCH BAR
	section.section.has-background-light
		.container
			h1.title.is-3.has-text-centered Search for yard sales in your area!
			form(method='post')
				.field.is-horizontal
					.field-body
						.field.has-addons
							p.control.has-icons-left.is-expanded
								input.input#searchParams(type='text' name='searchParams' placeholder='City, State, Zip Code, etc.')
								span.icon.is-small.is-left
									i.fas.fa-map-marker-alt
							p.control
								a.button.is-success(onclick='getLocation()') Find Me
							// Search returns all yardsales in DB on new page
							p.control
								a.button.is-link(href='/yardsales')
									span.icon
										i.fas.fa-search-location
									span Search
							// Search returns a view of user's current location
							//p.control
							//	input#submit(type='submit' value='Search')
	// MAP OF USA
	section.section.has-background-light
		.container
			#map(style='width:100%;height:500px')
			script(type='text/javascript' src='/js/index_map.js')
			//script(type='text/javascript' src='/js/reverse_geocoder.js')
			script(async defer src='https://maps.googleapis.com/maps/api/js?key='+process.env.MAPS_API_KEY+'&callback=initMap')
			script(type='text/javascript' src='/js/get_location.js')
			br
	// YARD SALE LIST
	section.section
		.container
			if yardsale_list && isAuthenticated
				each yardsale in yardsale_list
					article.media
						figure.media-left
							figure.image.is-128x128
								a(href='/yardsales/'+yardsale._id)
									if (yardsale.imagename !== undefined && yardsale.imagename !== '' && yardsale.imagename !== null)
										img(src='https://s3.amazonaws.com/yardy-pics/' + yardsale.user.username + '/' +
										yardsale.imagename alt='yard sale')
									else
										img(src='/images/yardsale_poster.jpg' alt='yard sale')
						.media-content
							.content
								p Location:&nbsp;&nbsp;
									strong #{yardsale.full_address}
								p Date:&nbsp;&nbsp;
									strong #{yardsale.date.toDateString()}&nbsp;
								p #{yardsale.description}
							nav.level.is-mobile
								.level-left
									a.level-item(href='/yardsales/'+yardsale._id) view details
						.media-right
							a.button.is-link.is-rounded
								span.icon
									i.fas.fa-star
			else
				h1.subtitle.has-text-centered
					strong.has-text-danger Please sign in to view more details about our yard sales.
				each yardsale in yardsale_list
					article.media
						figure.media-left
							figure.image.is-128x128
								if (yardsale.imagename !== undefined && yardsale.imagename !== '' && yardsale.imagename !== null)
									img(src='https://s3.amazonaws.com/yardy-pics/' + yardsale.user.username + '/' +
									yardsale.imagename alt='yard sale')
								else
									img(src='/images/yardsale_poster.jpg' alt='yard sale')
						.media-content
							.content
								p Locaion:&nbsp;&nbsp;
									strong #{yardsale.city}, #{yardsale.state}&nbsp;
								p Date:&nbsp;&nbsp;
									strong #{yardsale.date.toDateString()}&nbsp;
								p #{yardsale.description}
						.media-right
