extends layout

block content

	// Title & Search Bar
	section.section
		.container
			h1.title.is-3.has-text-centered Search for Yard Sales in your area!
			#demo.has-text-centered.has-text-link
			script.
				let x = document.getElementById('demo');

				function getLocation() {
					if (navigator.geolocation) {
						navigator.geolocation.getCurrentPosition(showPosition);
					} else {
						x.innerHTML = 'Geolocation is not supported by this browser.';
					}
				}

				function showPosition(position) {
					x.innerHTML = 'Latitude: ' + position.coords.latitude +
						' ' + 'Longitude: ' + position.coords.longitude;
				}
			br
			.field.is-horizontal
				.field-body
					.field.has-addons
						p.control.has-icons-left.is-expanded
							input.input(type='text' placeholder='City, State, Zip Code, etc.')
							span.icon.is-small.is-left
								i.fas.fa-map-marker-alt
						//.control#indexSort.has-icons-left
						//	.select
						//		select(id='sort' name='sort')
						//			option(selected) Sort (optional)
						//			option(value='date') Date
						//			option(value='starttime') Starting Time
						//			option(value='distance') Distance
						//		span.icon.is-small.is-left
						//			i.fas.fa-sort
						//p.control
						//	a.button.is-success(onclick='getLocation()')
						//			span.icon
						//				i.fas.fa-map-marker-alt
						//			span Get Location
						//.divider
						p.control
							a.button.is-link(href='/catalog/yardsales')
								span.icon
									i.fas.fa-search-location
								span Search
	br
	// MAP OF USA
	section.section
		.container
			#map(style='width:100%;height:500px')
			script(src='/js/index_map.js')
			script(async defer src='https://maps.googleapis.com/maps/api/js?key='+process.env.MAPS_API_KEY+'&callback=initMap')
			//script(async defer src='https://maps.googleapis.com/maps/api/js?key=AIzaSyDxjeLMjAFvZUwypcu0UpoCkAk4lJXShPQ&callback=initMap')

	// Results Section
	section.section
		.container
			if yardsale_list && isAuthenticated
				each yardsale in yardsale_list
					article.media
						figure.media-left
							figure.image.is-128x128
								a(href='/catalog/yardsale/'+yardsale._id)
									if (yardsale.imagename !== undefined && yardsale.imagename !== '' && yardsale.imagename !== null)
										img(src='https://s3.amazonaws.com/yardy-pics/' + yardsale.user.username + '/' +
										yardsale.imagename alt='yard sale')
									else
										img(src='/images/yardsale_poster.jpg' alt='yard sale')
						.media-content
							.content
								p
									strong #{yardsale.city}, #{yardsale.state}&nbsp;
									small #{yardsale.date}&nbsp;@&nbsp;
									small #{yardsale.starttime}
									br
								p Posted by #{yardsale.user.username}
								p #{yardsale.description}
							nav.level.is-mobile
								.level-left
									a.level-item
										span.icon.is-small
											i.fas.fa-envelope
									a.level-item
										span.icon.is-small
											i.fab.fa-twitter
									a.level-item
										span.icon.is-small
											i.fas.fa-heart
						.media-right
							a.button.is-link Add
			else
				h1.subtitle.has-text-centered.has-text-danger Please sign in to view more details about our yard sales.
				each yardsale in yardsale_list
					article.media
						figure.media-left
							figure.image.is-128x128
								if (yardsale.imagename !== undefined && yardsale.imagename !== '' && yardsale.imagename !== null)
									img(src='https://s3.amazonaws.com/yardy-pics/' + yardsale.user.username + '/' +
									yardsale.imagename alt='yard sale')
								else
									img(src='/images/yardsale_poster.jpg' alt='yard sale')
						.media-content
							.content
								p
									strong #{yardsale.state}&nbsp;
									small #{yardsale.date}
									br
								p #{yardsale.description}
						.media-right
